<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Editor Dashboard | Scientific Journal System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,700;0,900;1,300&family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-navy: #2c3e50;
      --accent-red: #c0392b;
      --bg-light: #f8f9fa;
      --font-serif: 'Merriweather', serif;
      --font-sans: 'Lato', sans-serif;
    }

    body { background-color: var(--bg-light); font-family: var(--font-sans); color: #333; }

    /* 顶部导航 */
    .journal-header {
      background: #fff;
      border-bottom: 3px solid var(--primary-navy);
      padding: 1.2rem 0;
      margin-bottom: 2rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.03);
    }
    .journal-title { font-family: var(--font-serif); font-weight: 900; font-size: 1.5rem; color: var(--primary-navy); }
    .user-profile { font-size: 0.9rem; color: #666; }

    /* 统计卡片 */
    .stat-card {
      background: #fff; border: none; border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.02);
      transition: transform 0.2s;
    }
    .stat-card:hover { transform: translateY(-2px); }
    .stat-number { font-size: 2rem; font-weight: 700; color: var(--primary-navy); }
    .stat-label { font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; color: #888; }

    /* 稿件列表 */
    .paper-card {
      background: #fff; border: 1px solid #e1e4e8; border-radius: 6px;
      margin-bottom: 1rem; padding: 1.5rem;
      border-left: 4px solid transparent;
      transition: all 0.2s;
    }
    .paper-card:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-color: #d1d5db; }

    /* 状态颜色 */
    .status-action { border-left-color: var(--accent-red); } /* 需要操作：With Editor */
    .status-wait { border-left-color: #3498db; }   /* 等待中：Under Review */
    .status-done { border-left-color: #27ae60; }   /* 已完成 */

    .paper-title { font-family: var(--font-serif); font-weight: 700; font-size: 1.2rem; color: #2c3e50; text-decoration: none; }
    .paper-meta { font-size: 0.85rem; color: #7f8c8d; margin-top: 0.5rem; }

    .action-btn { font-size: 0.85rem; font-weight: 600; }
  </style>
</head>
<body>

<header class="journal-header">
  <div class="container d-flex justify-content-between align-items-center">
    <div class="journal-title">International AI Research</div>
    <div class="user-profile">
      <span class="me-2">Editor Workspace</span>
      <span class="text-muted">|</span>
      <span class="ms-2 fw-bold" th:text="${session.loginUser.fullName}">Dr. Editor</span>
      <a href="/author/logout" class="ms-3 text-danger text-decoration-none small">Logout</a>
    </div>
  </div>
</header>

<div class="container">
  <div class="row mb-4 g-3">
    <div class="col-md-4">
      <div class="stat-card p-3 d-flex align-items-center justify-content-between">
        <div>
          <div class="stat-number" th:text="${#lists.size(manuscripts.?[status == 'With Editor'])}">3</div>
          <div class="stat-label">Tasks Required</div>
        </div>
        <i class="bi bi-exclamation-circle text-danger fs-3"></i>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stat-card p-3 d-flex align-items-center justify-content-between">
        <div>
          <div class="stat-number" th:text="${#lists.size(manuscripts.?[status == 'Under Review'])}">12</div>
          <div class="stat-label">Under Review</div>
        </div>
        <i class="bi bi-people text-primary fs-3"></i>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-between align-items-end mb-3 border-bottom pb-2">
    <h4 class="mb-0 fw-bold" style="font-family: var(--font-serif);">Manuscripts</h4>

    <div class="btn-group btn-group-sm">
      <a href="#" class="btn btn-outline-dark active">All</a>
      <a href="#" class="btn btn-outline-dark">Action Required</a>
    </div>
  </div>

  <div th:each="m : ${manuscripts}"
       class="paper-card"
       th:classappend="${m.status == 'With Editor' ? 'status-action' : (m.status == 'Under Review' ? 'status-wait' : 'status-done')}">

    <div class="row align-items-center">
      <div class="col-md-8">
        <div class="d-flex align-items-center mb-1">
          <span class="badge bg-light text-dark border me-2" th:text="${'#MS-' + m.manuscriptId}">ID</span>
          <span class="badge"
                th:classappend="${m.status == 'With Editor' ? 'bg-danger' : (m.status == 'Under Review' ? 'bg-primary' : 'bg-secondary')}"
                th:text="${m.status}">With Editor</span>
        </div>

        <a th:href="@{/editor/process/{id}(id=${m.manuscriptId})}" class="paper-title hover-underline">
          <span th:text="${m.title}">Paper Title Placeholder</span>
        </a>

        <div class="paper-meta">
          <i class="bi bi-calendar3"></i> Submitted: <span th:text="${#temporals.format(m.submitTime, 'MMM dd, yyyy')}">Date</span>
          <span class="mx-2">•</span>
          <i class="bi bi-person"></i> Author ID: <span th:text="${m.authorId}">123</span>
        </div>
      </div>

      <div class="col-md-4 text-end">
        <a th:if="${m.status == 'With Editor'}"
           th:href="@{/editor/process/{id}(id=${m.manuscriptId})}"
           class="btn btn-danger btn-sm action-btn px-4 shadow-sm">
          Process Now <i class="bi bi-arrow-right"></i>
        </a>

        <a th:if="${m.status == 'Under Review'}"
           th:href="@{/editor/process/{id}(id=${m.manuscriptId})}"
           class="btn btn-outline-primary btn-sm action-btn px-3">
          Monitor <i class="bi bi-eye"></i>
        </a>

        <a th:if="${m.status != 'With Editor' and m.status != 'Under Review'}"
           th:href="@{/editor/process/{id}(id=${m.manuscriptId})}"
           class="btn btn-outline-secondary btn-sm action-btn">
          View Details
        </a>
      </div>
    </div>
  </div>

  <div th:if="${#lists.isEmpty(manuscripts)}" class="text-center py-5 text-muted">
    <i class="bi bi-inbox fs-1"></i>
    <p class="mt-2">No manuscripts assigned to you yet.</p>
  </div>

</div>

</body>
</html>