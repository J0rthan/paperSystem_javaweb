<!doctype html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>消息列表</title>
    <style>
        :root{
            --card-bg:#fff;
            --border:#e6e8ee;
            --text:#1f2328;
            --muted:#6b7280;
            --shadow: 0 6px 18px rgba(0,0,0,.06);
            --hover:#f9fafb;
        }
        body{
            margin:0;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",Arial,sans-serif;
            color:var(--text);
            background:#f6f7fb;
        }

        /* 顶部栏 */
        .topbar{
            position:sticky;
            top:0;
            z-index:5;
            background:#fff;
            border-bottom:1px solid var(--border);
            padding:14px 18px;
            font-weight:600;
        }

        /* 外层：允许左右滑动 */
        .h-scroll{
            overflow-x:auto;
            padding:16px;
        }

        /* 两栏容器：给一个最小宽度，屏幕窄时会触发水平滚动 */
        .columns{
            display:flex;
            gap:16px;
            min-width: 980px;
        }

        .panel{
            flex: 1 1 0;
            background:var(--card-bg);
            border:1px solid var(--border);
            border-radius:14px;
            box-shadow:var(--shadow);
            overflow:hidden;
            min-height: 70vh;
            display:flex;
            flex-direction:column;
        }

        .panel-header{
            padding:12px 14px;
            border-bottom:1px solid var(--border);
            display:flex;
            align-items:center;
            justify-content:space-between;
            background:#fbfbfd;
            font-weight:600;
        }

        .badge{
            font-size:12px;
            color:var(--muted);
            font-weight:500;
        }

        /* 列表区：独立纵向滚动 */
        .list{
            padding:12px;
            overflow-y:auto;
            flex:1;
        }

        .item{
            border:1px solid var(--border);
            border-radius:12px;
            padding:10px 12px;
            background:#fff;
            margin-bottom:10px;
        }

        .meta{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            align-items:center;
            font-size:12px;
            color:var(--muted);
            margin-bottom:8px;
        }

        .meta strong{
            color:var(--text);
            font-weight:600;
            font-size:12px;
        }

        .content{
            margin:0;
            font-size:13px;
            line-height:1.45;
            color:#2f3337;
            white-space:pre-wrap;
            word-break:break-word;
        }

        /* 空状态 */
        .empty{
            padding:28px 10px;
            text-align:center;
            color:var(--muted);
            font-size:13px;
        }

        /* ✅ 分页区：固定在面板底部（不随 list 滚动） */
        .pager{
            padding:10px 12px;
            border-top:1px solid var(--border);
            background:#fff;
            display:flex;
            align-items:center;
            gap:10px;
            flex-wrap:wrap;
            justify-content:flex-start;
        }

        .pager .btn{
            height:32px;
            padding:0 12px;
            border-radius:10px;
            border:1px solid var(--border);
            background:#fff;
            cursor:pointer;
            font-weight:600;
            box-shadow:0 2px 10px rgba(0,0,0,.05);
            transition: transform .12s ease, background .12s ease, box-shadow .12s ease;
        }
        .pager .btn:hover{
            background:var(--hover);
            transform: translateY(-1px);
            box-shadow:0 10px 18px rgba(0,0,0,.06);
        }
        .pager .btn:disabled{
            opacity:.5;
            cursor:not-allowed;
            transform:none;
            box-shadow:none;
        }

        .pager select,
        .pager input{
            height:32px;
            padding:0 10px;
            border:1px solid var(--border);
            border-radius:10px;
            background:#fff;
            color:var(--text);
            outline:none;
        }
        .pager input{ width:70px; }

        .pager .info{
            color:var(--muted);
            font-size:12px;
            padding:0 4px;
            white-space:nowrap;
        }
    </style>
</head>

<body>
<div class="topbar">邮件箱（左：我发送的｜右：我收到的）</div>

<div class="h-scroll">
    <div class="columns">

        <!-- 左：我发送的 -->
        <section class="panel" id="sentPanel">
            <div class="panel-header">
                <div>我发送的</div>
                <div class="badge" th:text="'共 ' + ${#lists.size(sentMessages)} + ' 条'">共 0 条</div>
            </div>

            <div class="list" id="sentList">
                <div th:if="${sentMessages == null or #lists.isEmpty(sentMessages)}" class="empty">
                    暂无发送记录
                </div>

                <article class="item sent-item" th:each="m : ${sentMessages}">
                    <div class="meta">
                        <span><strong>To</strong> <span th:text="${m.getReceiverEmail()}">receiver@qq.com</span></span>
                        <span><strong>时间</strong>
                            <span th:text="${#temporals.format(m.getSendingTime(), 'yyyy-MM-dd HH:mm')}">2026-01-04 20:00</span>
                        </span>
                    </div>
                    <p class="content" th:utext="${m.getMessageBody()}">内容...</p>
                </article>
            </div>

            <!-- ✅ 左栏分页 -->
            <div class="pager" id="sentPager">
                <button type="button" class="btn" id="sentPrev">上一页</button>
                <span class="info" id="sentInfo"></span>
                <button type="button" class="btn" id="sentNext">下一页</button>

                <span class="info" style="margin-left:8px;">每页</span>
                <select id="sentSize">
                    <option value="5">5</option>
                    <option value="10" selected>10</option>
                    <option value="20">20</option>
                </select>
                <span class="info">条</span>

                <span class="info" style="margin-left:8px;">跳转</span>
                <input id="sentGoto" type="number" min="1" />
                <button type="button" class="btn" id="sentGoBtn">GO</button>
            </div>
        </section>

        <!-- 右：我收到的 -->
        <section class="panel" id="recvPanel">
            <div class="panel-header">
                <div>我收到的</div>
                <div class="badge" th:text="'共 ' + ${#lists.size(receivedMessage)} + ' 条'">共 0 条</div>
            </div>

            <div class="list" id="recvList">
                <div th:if="${receivedMessage == null or #lists.isEmpty(receivedMessage)}" class="empty">
                    暂无收件记录
                </div>

                <article class="item recv-item" th:each="m : ${receivedMessage}">
                    <div class="meta">
                        <span><strong>From</strong> <span th:text="${m.getSenderEmail()}">sender@qq.com</span></span>
                        <span><strong>时间</strong>
                            <span th:text="${#temporals.format(m.getSendingTime(), 'yyyy-MM-dd HH:mm')}">2026-01-04 20:00</span>
                        </span>
                    </div>
                    <p class="content" th:utext="${m.getMessageBody()}">内容</p>
                </article>
            </div>

            <!-- ✅ 右栏分页 -->
            <div class="pager" id="recvPager">
                <button type="button" class="btn" id="recvPrev">上一页</button>
                <span class="info" id="recvInfo"></span>
                <button type="button" class="btn" id="recvNext">下一页</button>

                <span class="info" style="margin-left:8px;">每页</span>
                <select id="recvSize">
                    <option value="5">5</option>
                    <option value="10" selected>10</option>
                    <option value="20">20</option>
                </select>
                <span class="info">条</span>

                <span class="info" style="margin-left:8px;">跳转</span>
                <input id="recvGoto" type="number" min="1" />
                <button type="button" class="btn" id="recvGoBtn">GO</button>
            </div>
        </section>

    </div>
</div>

<script>
    (function(){
        function setupPager(opts){
            const {
                itemSelector, listEl,
                prevBtn, nextBtn,
                infoEl, sizeSel,
                gotoInput, gotoBtn
            } = opts;

            const rows = Array.from(document.querySelectorAll(itemSelector));

            // 无数据：禁用本栏分页
            if(rows.length === 0){
                infoEl.textContent = "";
                prevBtn.disabled = true;
                nextBtn.disabled = true;
                sizeSel.disabled = true;
                gotoInput.disabled = true;
                gotoBtn.disabled = true;
                return;
            }

            let page = 1;
            let size = parseInt(sizeSel.value, 10);

            function totalPages(){
                return Math.max(1, Math.ceil(rows.length / size));
            }

            function render(){
                const tp = totalPages();
                if(page < 1) page = 1;
                if(page > tp) page = tp;

                const start = (page - 1) * size;
                const end = start + size;

                rows.forEach((r, i) => {
                    r.style.display = (i >= start && i < end) ? "" : "none";
                });

                infoEl.textContent = `第 ${page} / ${tp} 页，共 ${rows.length} 条`;
                prevBtn.disabled = (page === 1);
                nextBtn.disabled = (page === tp);

                if(listEl) listEl.scrollTop = 0;
            }

            prevBtn.addEventListener("click", () => { page--; render(); });
            nextBtn.addEventListener("click", () => { page++; render(); });

            sizeSel.addEventListener("change", () => {
                size = parseInt(sizeSel.value, 10);
                page = 1;
                render();
            });

            gotoBtn.addEventListener("click", () => {
                const p = parseInt(gotoInput.value, 10);
                if(!isNaN(p)){
                    page = p;
                    render();
                }
            });

            gotoInput.addEventListener("keydown", (e) => {
                if(e.key === "Enter") gotoBtn.click();
            });

            render();
        }

        // 左栏分页
        setupPager({
            itemSelector: ".sent-item",
            listEl: document.getElementById("sentList"),
            prevBtn: document.getElementById("sentPrev"),
            nextBtn: document.getElementById("sentNext"),
            infoEl: document.getElementById("sentInfo"),
            sizeSel: document.getElementById("sentSize"),
            gotoInput: document.getElementById("sentGoto"),
            gotoBtn: document.getElementById("sentGoBtn")
        });

        // 右栏分页
        setupPager({
            itemSelector: ".recv-item",
            listEl: document.getElementById("recvList"),
            prevBtn: document.getElementById("recvPrev"),
            nextBtn: document.getElementById("recvNext"),
            infoEl: document.getElementById("recvInfo"),
            sizeSel: document.getElementById("recvSize"),
            gotoInput: document.getElementById("recvGoto"),
            gotoBtn: document.getElementById("recvGoBtn")
        });
    })();
</script>

</body>
</html>